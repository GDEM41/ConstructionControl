<UserControl x:Class="ConstructionControl.ArrivalControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid Margin="10"
          Loaded="UserControl_Loaded">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ВЕРХ -->
        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Тип материала:"
                       VerticalAlignment="Center"
                       Margin="0,0,5,0"/>

            <ComboBox x:Name="MaterialGroupBox"
                      Width="200"
                      IsEditable="True"
                      IsTextSearchEnabled="False"/>

            <TextBlock Text="ТТН:"
                       VerticalAlignment="Center"
                       Margin="15,0,5,0"/>

            <TextBox x:Name="TtnBox"
                     Width="150"/>
        </StackPanel>

        <!-- ТАБЛИЦА -->
        <DataGrid x:Name="ItemsGrid"
                  Grid.Row="1"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False">

            <DataGrid.Columns>

                <DataGridTextColumn Header="Дата"
                                    Binding="{Binding Date, StringFormat=dd.MM.yyyy}"
                                    Width="90"/>

                <DataGridTemplateColumn Header="Наименование" Width="220">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding MaterialName}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <DataGridTemplateColumn.CellEditingTemplate>
                        <DataTemplate>
                            <ComboBox IsEditable="True"
          IsTextSearchEnabled="False"
          Text="{Binding MaterialName, UpdateSourceTrigger=PropertyChanged}"
          ItemsSource="{Binding AvailableNames}"
          LostFocus="Material_LostFocus"/>

                        </DataTemplate>
                    </DataGridTemplateColumn.CellEditingTemplate>
                </DataGridTemplateColumn>

                <DataGridTextColumn Header="Количество"
                                    Binding="{Binding Quantity}"
                                    Width="90"/>

                <DataGridTemplateColumn Header="Ед." Width="80">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Unit}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>

                    <DataGridTemplateColumn.CellEditingTemplate>
                        <DataTemplate>
                            <TextBox Text="{Binding Unit, UpdateSourceTrigger=PropertyChanged}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellEditingTemplate>
                </DataGridTemplateColumn>




                <DataGridTextColumn Header="Паспорт"
                                    Binding="{Binding Passport}"
                                    Width="120"/>

                <DataGridTextColumn Header="СТБ"
                                    Binding="{Binding Stb}"
                                    Width="80"/>

                <DataGridTextColumn Header="Поставщик"
                                    Binding="{Binding Supplier}"
                                    Width="150"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- КНОПКИ -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,14,0,0">

            <Button Content="➕ Добавить строку"
                    Height="36"
                    MinWidth="160"
                    Padding="14,0"
                    FontSize="14"
                    Margin="0,0,10,0"
                    Click="AddRow_Click"/>

            <Button Content="📥 Добавить приход"
                    Height="36"
                    MinWidth="180"
                    Padding="14,0"
                    FontSize="14"
                    Background="#2F80ED"
                    Foreground="White"
                    BorderBrush="#2F80ED"
                    Click="AddArrival_Click"/>
        </StackPanel>

    </Grid>
</UserControl>

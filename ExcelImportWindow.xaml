<Window x:Class="ConstructionControl.ExcelImportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Импорт из Excel"
        Height="500"
        Width="800"
        WindowStartupLocation="CenterOwner">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Файл -->
        <Border BorderBrush="#CCC" BorderThickness="1" Padding="6" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock Text="Файл:" FontWeight="Bold"/>
                <TextBlock x:Name="FilePathText"
                           TextWrapping="Wrap"
                           Foreground="Gray"/>
            </StackPanel>
        </Border>

        <!-- Основная область -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Листы -->
            <Border BorderBrush="#CCC" BorderThickness="1" Padding="5">
                <StackPanel>
                    <TextBlock Text="Листы Excel"
                               FontWeight="Bold"
                               Margin="0,0,0,5"/>

                    <ListBox x:Name="SheetsList"
                              Height="300"  
                              SelectionChanged="SheetsList_SelectionChanged"/>

                </StackPanel>
            </Border>

            <!-- Разделитель -->
            <GridSplitter Grid.Column="1"
                          Width="5"
                          HorizontalAlignment="Stretch"/>

            <Border Grid.Column="2"
                    BorderBrush="#CCC"
                    BorderThickness="1"
                    Padding="5">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Предпросмотр листа"
               FontWeight="Bold"
               Margin="0,0,0,5"/>

                    <!-- Таблица -->
                    <DataGrid x:Name="PreviewGrid"
                                  Grid.Row="1"
                                  IsReadOnly="True"
                                  AutoGenerateColumns="True"
                                  HeadersVisibility="All"
                                  GridLinesVisibility="All"
                                  CanUserAddRows="False"
                                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                                  ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                  SelectedCellsChanged="PreviewGrid_SelectedCellsChanged"/>

                    <!-- Кнопки выбора -->
                    <StackPanel Grid.Row="2"
                                    Orientation="Horizontal"
                                    Margin="0,5,0,0">

                        <Button Content="Это строка дат"
                                    Margin="0,0,5,0"
                                    Click="SelectDateRow_Click"/>

                        <Button Content="Это колонка материалов"
                                    Margin="0,0,5,0"
                                    Click="SelectMaterialColumn_Click"/>

                        <Button Content="Отсюда начинаются количества"
                                    Click="SelectQuantityStart_Click"/>
                    </StackPanel>
                </Grid>


            </Border>

        </Grid>

        <!-- Кнопки -->
        <Grid Grid.Row="2" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Координата -->
            <TextBlock x:Name="SelectedCellText"
               VerticalAlignment="Center"
               Foreground="Gray"
               Text="Ячейка не выбрана"/>

            <!-- Кнопки -->
            <StackPanel Grid.Column="1"
                Orientation="Horizontal">

                <Button Content="Импорт"
                Width="100"
                Margin="0,0,5,0"
                Click="Import_Click"/>

                <Button Content="Отмена"
                Width="100"
                Click="Cancel_Click"/>
            </StackPanel>
        </Grid>

    </Grid>
</Window>

<Window x:Class="ConstructionControl.ExcelImportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Импорт из Excel"
        Height="500"
        Width="800"
        WindowStartupLocation="CenterOwner">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Файл -->
        <Border BorderBrush="#CCC" BorderThickness="1" Padding="6" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock Text="Файл:" FontWeight="Bold"/>
                <TextBlock x:Name="FilePathText"
                           TextWrapping="Wrap"
                           Foreground="Gray"/>
            </StackPanel>
        </Border>

        <!-- Основная область -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Листы -->
            <Border BorderBrush="#CCC" BorderThickness="1" Padding="5">
                <StackPanel>
                    <TextBlock Text="Листы Excel"
                               FontWeight="Bold"
                               Margin="0,0,0,5"/>

                    <ListBox x:Name="SheetsList"
                              Height="300"  
                              SelectionChanged="SheetsList_SelectionChanged"/>

                </StackPanel>
            </Border>

            <!-- Разделитель -->
            <GridSplitter Grid.Column="1"
                          Width="5"
                          HorizontalAlignment="Stretch"/>

            <Border Grid.Column="2"
                    BorderBrush="#CCC"
                    BorderThickness="1"
                    Padding="5">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Заголовок -->
                    <TextBlock Text="Предпросмотр листа"
                                      FontWeight="Bold"
                                      Margin="0,0,0,5"
                                      Grid.Row="0"/>

                    <!-- Таблица -->
                    <DataGrid x:Name="PreviewGrid"
                                     Grid.Row="1"
                                     IsReadOnly="True"
                                     AutoGenerateColumns="True"
                                     HeadersVisibility="All"
                                     GridLinesVisibility="All"
                                     CanUserAddRows="False"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     ScrollViewer.HorizontalScrollBarVisibility="Auto"/>
                </Grid>

            </Border>

        </Grid>

        <!-- Кнопки -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,10,0,0">

            <Button Content="Импорт"
                    Width="100"
                    Margin="0,0,5,0"
                    IsEnabled="False"/>

            <Button Content="Отмена"
                    Width="100"
                    Click="Cancel_Click"/>
        </StackPanel>
    </Grid>
</Window>

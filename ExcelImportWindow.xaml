<Window x:Class="ConstructionControl.ExcelImportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Импорт из Excel"
        Height="500"
        Width="1000"
        WindowStartupLocation="CenterOwner">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Файл -->
        <Border BorderBrush="#CCC" BorderThickness="1" Padding="6" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock Text="Файл:" FontWeight="Bold"/>
                <TextBlock x:Name="FilePathText"
                           TextWrapping="Wrap"
                           Foreground="Gray"/>
            </StackPanel>
        </Border>

        <!-- Основная область -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Листы -->
            <Border BorderBrush="#CCC" BorderThickness="1" Padding="5">
                <StackPanel>
                    <TextBlock Text="Листы Excel"
                               FontWeight="Bold"
                               Margin="0,0,0,5"/>

                    <ListBox x:Name="SheetsList"
                              Height="300"  
                              SelectionChanged="SheetsList_SelectionChanged"/>

                </StackPanel>
            </Border>

            <!-- Разделитель -->
            <GridSplitter Grid.Column="1"
                          Width="5"
                          HorizontalAlignment="Stretch"/>

            <Border Grid.Column="2"
                    BorderBrush="#CCC"
                    BorderThickness="1"
                    Padding="5">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Предпросмотр листа"
               FontWeight="Bold"
               Margin="0,0,0,5"/>

                    <!-- Таблица -->
                    <DataGrid x:Name="PreviewGrid"
                             Grid.Row="1"
                             AutoGenerateColumns="True"
                             SelectionUnit="Cell"
                             SelectionMode="Single"
                             SelectedCellsChanged="PreviewGrid_SelectedCellsChanged"/>


                    <!-- Кнопки выбора -->
                    <StackPanel Grid.Row="2"
            Orientation="Horizontal"
            Margin="0,5,0,0">

                        <Button Content="📅 Дата"
            Tag="Date"
            Click="SelectCell_Click"
            Margin="1"/>

                        <Button Content="🧱 Наименование"
            Tag="Material"
            Click="SelectCell_Click"
            Margin="1"/>

                        <Button Content="🔢 Кол-во"
            Tag="Quantity"
            Click="SelectCell_Click"
            Margin="1"/>

                        <Separator Width="8"/>

                        <Button Content="🧾 Позиция"
            Tag="Position"
            Click="SelectCell_Click"
            Margin="1"/>

                        <Button Content="📐 Ед. изм"
            Tag="Unit"
            Click="SelectCell_Click"
            Margin="1"/>

                        <Button Content="📦 Объем"
            Tag="Volume"
            Click="SelectCell_Click"
            Margin="1"/>

                        <Button Content="🏷 СТБ"
            Tag="Stb"
            Click="SelectCell_Click"
            Margin="1"/>

                        <Separator Width="8"/>

                        <Button Content="🚚 ТТН"
            Tag="Ttn"
            Click="SelectCell_Click"
            Margin="1"/>

                        <Button Content="🏭 Поставщик"
            Tag="Supplier"
            Click="SelectCell_Click"
            Margin="1"/>

                        <Button Content="📄 Паспорт"
            Tag="Passport"
            Click="SelectCell_Click"
            Margin="1"/>

                    </StackPanel>

                </Grid>


            </Border>

        </Grid>

        <!-- Кнопки -->
        <Grid Grid.Row="2" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Координата -->
            <TextBlock x:Name="SelectedCellText"
               VerticalAlignment="Center"
               Foreground="Gray"
               Text="Ячейка не выбрана"/>

            <!-- Кнопки -->
            <StackPanel Grid.Column="1"
            Orientation="Horizontal"
            Margin="0,5,0,0">

                <Button Content="Импорт"
            Click="Import_Click"/>

                <Button Content="💾 Сохранить шаблон"
            Click="SaveTemplate_Click"
            Margin="5,0,0,0"/>
                
                <Button Content="✅ Применить"
        Click="ApplyTemplate_Click"
        Margin="5,0,0,0"/>

                <ComboBox x:Name="TemplatesCombo"
              Width="200"
              Margin="10,0,0,0"
              SelectionChanged="TemplatesCombo_SelectionChanged"/>

            </StackPanel>


        </Grid>

    </Grid>
</Window>
